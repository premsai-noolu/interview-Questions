ğŸ”¥ SQL Interview Questions (Must-Prepare)
ğŸŸ¢ Basics (Very Important)

1. What is SQL?

SQL (Structured Query Language) is a standard language used to communicate with relational databases. It allows us to store, retrieve, update, delete, and manage data in a database.

With SQL, you can:

Create database structures (tables, indexes, views)
Insert, update, and delete data
Retrieve data using queries
Control user access and permissions
Manage transactions

2. Difference between DDL, DML, DCL, TCL

ğŸ”¹ DDL â€“ Data Definition Language
Purpose: Defines and modifies the structure of database objects

Commands:
CREATE
ALTER
DROP
TRUNCATE
RENAME

Example:

CREATE TABLE Employee (
  id INT PRIMARY KEY,
  name VARCHAR(50)
);

ğŸ‘‰ DDL affects schema, not the data itself.

ğŸ”¹ DML â€“ Data Manipulation Language
Purpose: Used to insert, update, delete, and retrieve data

Commands:
INSERT
UPDATE
DELETE
SELECT

Example:

UPDATE Employee
SET salary = 60000
WHERE id = 101;

ğŸ‘‰ DML works on data inside tables.

ğŸ”¹ DCL â€“ Data Control Language
Purpose: Controls access and permissions to database objects

Commands:
GRANT
REVOKE

Example:

GRANT SELECT ON Employee TO user1;

ğŸ‘‰ It gives permission to user1 to read data from the Employee table.user1 can run SELECT queries on the Employee table, but cannot insert, update, or delete data.

ğŸ‘‰ DCL ensures security.

ğŸ”¹ TCL â€“ Transaction Control Language

Purpose: Manages transactions and maintains data consistency

Commands:

COMMIT
ROLLBACK
SAVEPOINT

Example:

SAVEPOINT sp1;
ROLLBACK TO sp1;
COMMIT;

Explanation of Each Statement
ğŸ”¹ SAVEPOINT sp1;

Creates a checkpoint inside a transaction
Lets you partially roll back without losing everything

Think of it as:
â€œRemember this position so I can come back here if needed.â€

ğŸ”¹ ROLLBACK TO sp1;

Undoes all changes made after sp1
Keeps all changes before sp1

ğŸ‘‰ Only partial rollback, not full rollback.

ğŸ”¹ COMMIT;

Permanently saves the current state of the transaction

After COMMIT, changes cannot be undone

Real Example (Very Important)
BEGIN;

INSERT INTO Employee VALUES (1, 'Tony', 50000);

SAVEPOINT sp1;

INSERT INTO Employee VALUES (2, 'Steve', 60000);

ROLLBACK TO sp1;

COMMIT;

Final Result in Table:

âœ… Tony is inserted
âŒ Steve is NOT inserted

Because:

ROLLBACK TO sp1 removed Steve
COMMIT saved Tony permanently

ğŸ‘‰ TCL ensures ACID properties.

3. Difference between DELETE, TRUNCATE, DROP

ğŸ”¹ DELETE
Purpose: Removes specific rows or all rows from a table

Key Points

Can use WHERE clause
Row-by-row operation
Can be rolled back (if not committed)
Table structure remains

Example
DELETE FROM Employee WHERE dept = 'HR';

ğŸ”¹ TRUNCATE
Purpose: Removes all rows from a table at once

Key Points

WHERE clause âŒ not allowed
Faster than DELETE
Cannot be rolled back (in most DBs)
Resets auto-increment
Table structure remains

Example
TRUNCATE TABLE Employee;

ğŸ”¹ DROP
Purpose: Deletes the entire table structure

Key Points

Removes data + structure
Cannot be rolled back
Frees storage space
Table no longer exists

Example
DROP TABLE Employee;

4. What is a primary key?

A primary key is a column (or combination of columns) in a table that uniquely identifies each row in that table.

Key Characteristics (Very Important for Interviews)

âœ… Unique â€“ no two rows can have the same value
âŒ Cannot be NULL â€“ every row must have a value
ğŸ“Œ Only one primary key per table
âš¡ Automatically creates an index (in most databases)

Simple Example
CREATE TABLE Employee (
  emp_id INT PRIMARY KEY,
  name VARCHAR(50),
  salary INT
);


Here:

emp_id uniquely identifies each employee
No duplicate or NULL values allowed in emp_id

Composite Primary Key:
A primary key can consist of multiple columns.
PRIMARY KEY (order_id, product_id)

Used when a single column is not enough to ensure uniqueness.

A primary key uniquely identifies each record in a table and does not allow duplicate or NULL values.

5. Difference between primary key and unique key

ğŸ”‘ Primary Key
Purpose: Uniquely identifies each row in a table

Key Points
Only one primary key per table
Does NOT allow NULL values
Automatically creates an index
Ensures entity integrity

Example
CREATE TABLE Employee (
  emp_id INT PRIMARY KEY,
  email VARCHAR(100) UNIQUE
);

ğŸ”‘ Unique Key
Purpose: Ensures uniqueness of a column

Key Points
Multiple unique keys allowed per table
Allows one NULL value (DB-dependent)
Automatically creates an index
Ensures data uniqueness

A primary key uniquely identifies a record and does not allow NULLs, whereas a unique key only enforces uniqueness and can allow NULL values.

6. What is a foreign key?

A foreign key is a column (or set of columns) in one table that refers to the primary key (or unique key) of another table.
It is used to maintain a relationship between tables and ensure referential integrity.

Simple Example
CREATE TABLE Department (
  dept_id INT PRIMARY KEY,
  dept_name VARCHAR(50)
);

CREATE TABLE Employee (
  emp_id INT PRIMARY KEY,
  name VARCHAR(50),
  dept_id INT,
  FOREIGN KEY (dept_id) REFERENCES Department(dept_id)
);

Department.dept_id â†’ Primary Key
Employee.dept_id â†’ Foreign Key

ğŸ‘‰ Every dept_id in Employee must exist in Department.

Key Characteristics (Interview Important)
Can have duplicate values
Can allow NULL values
Enforces referential integrity
Prevents invalid data insertion

What Foreign Key Prevents
âŒ Inserting an employee with a non-existing department

Example (Very Clear)
Parent Table
Department
-----------
dept_id
---------
10
20
30

Child Table
Employee
-----------
emp_id | dept_id

Here:

Employee.dept_id is a foreign key
It references Department.dept_id

âŒ Invalid Data Insertion (Blocked)
INSERT INTO Employee (emp_id, dept_id)
VALUES (1, 99);

âŒ Error occurs because:
dept_id = 99 does NOT exist in Department
ğŸ‘‰ This is invalid data, and the foreign key prevents it.

7. What is NULL? How is it different from 0 or empty string?

NULL represents the absence of a value or unknown value in a database.

ğŸ‘‰ It means:
Value is not provided
Value is unknown
Value is not applicable

âš ï¸ NULL is not a value.

ğŸ”¹ Examples:

while querying
salary IS NULL -- correct

0
salary = 0

Means salary is zero.

Empty String
name = ''

Means name exists but is empty.

ğŸ”¹ Behavior in Queries
COUNT difference
COUNT(*)        -- counts all rows
COUNT(salary)  -- ignores NULL values


8. What is constraint? Name different constraints

A constraint is a rule applied to a table or column to restrict the type of data that can be stored in it.
Constraints help maintain data accuracy, consistency, and integrity in a database.

ğŸ”‘ Different Types of Constraints (Very Important)
1ï¸âƒ£ NOT NULL

Ensures a column cannot have NULL values
name VARCHAR(50) NOT NULL

2ï¸âƒ£ UNIQUE

Ensures all values are unique
email VARCHAR(100) UNIQUE

3ï¸âƒ£ PRIMARY KEY

Uniquely identifies each row
(No duplicates, no NULLs)
id INT PRIMARY KEY

4ï¸âƒ£ FOREIGN KEY

Creates a relationship between tables
Prevents invalid data insertion
FOREIGN KEY (dept_id) REFERENCES Department(dept_id)

5ï¸âƒ£ CHECK

Restricts values based on a condition
age INT CHECK (age >= 18)

6ï¸âƒ£ DEFAULT

Assigns a default value if none is provided
status VARCHAR(20) DEFAULT 'Active'


9. What is index? Why do we use it?

An index is a database object that improves the speed of data retrieval (SELECT queries) on a table by allowing the database to find rows quickly without scanning the entire table.

ğŸ” Why do we use Indexes?
1ï¸âƒ£ Faster SELECT Queries

Without index:

Database performs full table scan
Slower for large tables

With index:

Database uses index lookup
Much faster search

3ï¸âƒ£ Enforces Uniqueness (Sometimes)

PRIMARY KEY and UNIQUE constraints create indexes automatically.

Example:

Without Index (Slow Query)
Table: Employee
emp_id	name	salary
1	A	30000
2	B	40000
3	C	50000
...	...	...
100000	Z	80000
Query
SELECT *
FROM Employee
WHERE salary = 50000;

What happens?

Database checks each row one by one
This is called a full table scan

âŒ Slow when table is large

Create Index
CREATE INDEX idx_salary ON Employee(salary);

With Index (Fast Query)
Now run the same query:

Database looks into index structure
Directly jumps to rows with salary = 50000
ğŸš€ Much faster

10.-------------------------------------------------------------
ğŸŸ¡ Joins (Extremely Important)

Types of joins in SQL

Difference between INNER JOIN and LEFT JOIN

Difference between LEFT JOIN and RIGHT JOIN

What is SELF JOIN?

What is CROSS JOIN?

ğŸ”— Types of JOINs in SQL
Main Types of Joins

INNER JOIN
LEFT JOIN (LEFT OUTER JOIN)
RIGHT JOIN (RIGHT OUTER JOIN)
FULL JOIN (FULL OUTER JOIN) (some DBs)
SELF JOIN
CROSS JOIN

1ï¸âƒ£ INNER JOIN
What is INNER JOIN?

Returns only the matching rows from both tables.

Example Tables

Employee

emp_id	name	dept_id
1	Tony	10
2	Steve	20
3	Bruce	30

Department

dept_id	dept_name
10	IT
20	HR
Query
SELECT e.name, d.dept_name
FROM Employee e
INNER JOIN Department d
ON e.dept_id = d.dept_id;

Output
name	dept_name
Tony	IT
Steve	HR

ğŸ‘‰ Bruce is excluded because dept_id 30 has no match

Interview One-Liner â­
INNER JOIN returns only records that have matching values in both tables.

2ï¸âƒ£ LEFT JOIN (LEFT OUTER JOIN)
What is LEFT JOIN?

Returns:

All rows from left table
Matching rows from right table
NULL if no match

Query
SELECT e.name, d.dept_name
FROM Employee e
LEFT JOIN Department d
ON e.dept_id = d.dept_id;

Output
name	dept_name
Tony	IT
Steve	HR
Bruce	NULL

ğŸ‘‰ Bruce is included because LEFT JOIN keeps all left table records

Interview One-Liner â­
LEFT JOIN returns all rows from the left table and matching rows from the right table.

ğŸ” Difference: INNER JOIN vs LEFT JOIN
Matching rows	   Only matching	    All left rows
Non-matching rows	Excluded	       Included with NULL
Use case	     Strict matching	     Find missing records

3ï¸âƒ£ RIGHT JOIN (RIGHT OUTER JOIN)
What is RIGHT JOIN?

Returns:
All rows from right table
Matching rows from left table
NULL if no match

Query
SELECT e.name, d.dept_name
FROM Employee e
RIGHT JOIN Department d
ON e.dept_id = d.dept_id;

Output
name	dept_name
Tony	IT
Steve	HR

(If Department had extra rows, they would appear with NULL employee)

ğŸ“Œ Interview Tip:
RIGHT JOIN can always be rewritten using LEFT JOIN.

ğŸ”— FULL JOIN (FULL OUTER JOIN)

A FULL JOIN returns:

All matching rows
All non-matching rows from the LEFT table
All non-matching rows from the RIGHT table

ğŸ‘‰ If there is no match on either side, the missing columns are filled with NULL.

4ï¸âƒ£ SELF JOIN
What is SELF JOIN?

A table joined with itself.
Used when rows in a table are related to other rows in the same table.

Example Table: Employee
emp_id	name	manager_id
1	Tony	NULL
2	Steve	1
3	Bruce	1
Query
SELECT e.name AS Employee, m.name AS Manager
FROM Employee e
LEFT JOIN Employee m
ON e.manager_id = m.emp_id;

Output
Employee	Manager
Tony	NULL
Steve	Tony
Bruce	Tony
Interview One-Liner â­
SELF JOIN is used to join a table with itself using aliases.

5ï¸âƒ£ CROSS JOIN
What is CROSS JOIN?

Returns Cartesian product:
Every row from table A
Combined with every row from table B

Example

Table A â†’ 2 rows
Table B â†’ 3 rows

ğŸ‘‰ Result = 2 Ã— 3 = 6 rows

Query:
SELECT *
FROM A
CROSS JOIN B;

Use Case

Creating combinations
Generating test data

Interview One-Liner â­
CROSS JOIN returns all possible combinations of rows from both tables.

11. Write a query to fetch records present in table A but not in table B

ğŸ‘‰ Fetch records present in Table A but NOT in Table B

Example Tables
TableA (Employees)
id	name
1	Tony
2	Steve
3	Bruce
4	Peter
TableB (Employees on Project)
id
1
3
Expected Output

Employees present in TableA but not in TableB

id	name
2	Steve
4	Peter
âœ… Best Query (Interview Preferred)
SELECT A.*
FROM TableA A
LEFT JOIN TableB B
  ON A.id = B.id
WHERE B.id IS NULL;

How This Query Works (Explain Like This in Interview)
Step 1: LEFT JOIN
FROM TableA A
LEFT JOIN TableB B
ON A.id = B.id;

Result after join:

A.id	A.name	B.id
1	Tony	1
2	Steve	NULL
3	Bruce	3
4	Peter	NULL

All rows from TableA are kept

Matching rows from TableB are joined

Non-matching rows get NULL in B.id

Step 2: Filter NULLs
WHERE B.id IS NULL;

This filters rows where:

There is no matching record in TableB

Final Output:

id	name
2	Steve
4	Peter

â­ Interview One-Liner Answer

By using a LEFT JOIN and filtering rows where the right tableâ€™s key is NULL, we can fetch records present in Table A but not in Table B.

----------------------------------------------------------------------------------------------------------------------------------------------
ğŸŸ¡ Functions & Clauses

12. Difference between WHERE and HAVING

Letâ€™s explain WHERE vs HAVING with a very clear example, step by step, exactly how you can say it in an interview.

Example Table: Employee
emp_id	name	dept	salary
1	Tony	IT	60000
2	Steve	IT	55000
3	Bruce	HR	40000
4	Natasha	HR	45000
5	Peter	HR	70000
ğŸ”¹ WHERE Example (Row-level filtering)
Question:

ğŸ‘‰ Get employees whose salary is greater than 50,000

SELECT *
FROM Employee
WHERE salary > 50000;

How it works:

SQL checks each row
Filters rows before grouping

Output:
emp_id	name	dept	salary
1	Tony	IT	60000
2	Steve	IT	55000
5	Peter	HR	70000

ğŸ”¹ HAVING Example (Group-level filtering)
Question:

ğŸ‘‰ Get departments whose average salary is greater than 55,000

SELECT dept, AVG(salary)
FROM Employee
GROUP BY dept
HAVING AVG(salary) > 55000;

How it works:

Rows are grouped by dept
AVG(salary) is calculated per group
HAVING filters the groups

Output:
dept	avg_salary
IT	    57500
âŒ Why WHERE Cannot Replace HAVING
WHERE AVG(salary) > 55000; -- âŒ INVALID

Because:

WHERE runs before GROUP BY
Aggregate functions are not available yet

ğŸ” Using WHERE and HAVING Together
Question:
ğŸ‘‰ Departments with more than 1 employee earning above 45,000

SELECT dept, COUNT(*)
FROM Employee
WHERE salary > 45000
GROUP BY dept
HAVING COUNT(*) > 1;

Explanation:

WHERE â†’ filters employees first
GROUP BY â†’ groups remaining rows
HAVING â†’ filters groups

â­ Interview One-Liner
WHERE filters individual rows before grouping, while HAVING filters aggregated groups after GROUP BY.

ğŸ§  Easy Way to Remember

WHERE = row filter
HAVING = group filter

13. Difference between GROUP BY and ORDER BY

GROUP BY:

Used to group rows that have the same values
Commonly used with aggregate functions (COUNT, SUM, AVG, MAX, MIN)
Reduces multiple rows into one row per group

Example

ğŸ‘‰ Find total salary per department

SELECT dept, SUM(salary) AS total_salary
FROM Employee
GROUP BY dept;

How it works:

Rows are grouped by dept
SUM(salary) is calculated per group

Sample Output
dept	total_salary
IT	115000
HR	155000

ğŸ”¹ ORDER BY
What is ORDER BY?

Used to sort the result set
Does not change number of rows
Can sort in ASC (default) or DESC

Example

ğŸ‘‰ List employees sorted by salary

SELECT *
FROM Employee
ORDER BY salary DESC;

Sample Output
name	salary
Peter	70000
Tony	60000
Steve	55000
Natasha	45000
Bruce	40000

ğŸ” Using GROUP BY and ORDER BY Together
SELECT dept, AVG(salary) AS avg_salary
FROM Employee
GROUP BY dept
ORDER BY avg_salary DESC;

ğŸ‘‰ Groups first, then sorts the grouped results.

â­ Interview One-Liner
GROUP BY groups rows to apply aggregate functions, while ORDER BY sorts the final result set.

ğŸ§  Easy Way to Remember
GROUP BY â†’ combine rows
ORDER BY â†’ arrange rows

14. What are aggregate functions?

Aggregate functions are built-in SQL functions that perform calculations on multiple rows and return a single summarized value.

They are commonly used with the GROUP BY clause.

ğŸ”‘ Common Aggregate Functions (Very Important)
1ï¸âƒ£ COUNT()

Returns the number of rows
SELECT COUNT(*) FROM Employee;

COUNT(*) â†’ counts all rows
COUNT(column) â†’ ignores NULL values

2ï¸âƒ£ SUM()

Returns the total of numeric values
SELECT SUM(salary) FROM Employee;

3ï¸âƒ£ AVG()

Returns the average value
SELECT AVG(salary) FROM Employee;

4ï¸âƒ£ MAX()

Returns the highest value
SELECT MAX(salary) FROM Employee;

5ï¸âƒ£ MIN()

Returns the lowest value
SELECT MIN(salary) FROM Employee;

ğŸ§  Example Table: Employee
emp_id	dept	salary
1	IT	60000
2	IT	55000
3	HR	40000
4	HR	45000
Aggregate + GROUP BY Example

ğŸ‘‰ Average salary per department

SELECT dept, AVG(salary) AS avg_salary
FROM Employee
GROUP BY dept;

Output
dept	avg_salary
IT	57500
HR	42500
Important Rules (Interview Favorites)

Aggregate functions ignore NULL values (except COUNT(*))
Cannot use aggregate functions in WHERE
Must use HAVING for conditions on aggregates

âŒ Wrong:

WHERE AVG(salary) > 50000

âœ… Correct:

HAVING AVG(salary) > 50000

15. What is COUNT(*) vs COUNT(column)

What does COUNT(*) do:

Counts all rows in a table or group

Includes NULL values
Counts rows regardless of column values

Example
SELECT COUNT(*) FROM Employee;

ğŸ‘‰ Returns the total number of rows

ğŸ”¢ COUNT(column)
What does COUNT(column) do?

Counts only non-NULL values in a specific column
Ignores NULL values

Example
SELECT COUNT(salary) FROM Employee;

ğŸ‘‰ Counts only rows where salary is NOT NULL

ğŸ§  Example Table: Employee
emp_id	name	salary
1	Tony	60000
2	Steve	NULL
3	Bruce	40000
4	Natasha	NULL
Result Comparison
SELECT COUNT(*) FROM Employee;      -- 4
SELECT COUNT(salary) FROM Employee; -- 2

16. What is COALESCE()?

COALESCE() is a SQL function used to replace NULL values.
It returns the first non-NULL value from the list of arguments.

COALESCE(value1, value2, ..., valueN)

ğŸ‘‰ SQL checks values from left to right and returns the first one that is NOT NULL.

Simple Example
SELECT COALESCE(NULL, NULL, 5000);

Output
5000

Real Example (Very Important)
Employee Table
emp_id	name	salary	bonus
1	Tony	60000	NULL
2	Steve	NULL	5000
Query
SELECT name,
       COALESCE(salary, bonus, 0) AS final_amount
FROM Employee;

Output
name	final_amount
Tony	60000
Steve	5000
Why do we use COALESCE?

Handle NULL values
Avoid calculation errors
Display meaningful default values

16. What is a subquery?

A subquery is a query written inside another SQL query.
It is used to provide intermediate results that the main (outer) query uses to complete its task.

ğŸ‘‰ In simple words:

A subquery is a query within a query.
Where Can Subqueries Be Used?

Subqueries can be used in:

WHERE clause
SELECT clause
FROM clause
HAVING clause

Simple Example
Find employees earning more than the average salary
SELECT *
FROM Employee
WHERE salary > (
    SELECT AVG(salary)
    FROM Employee
);

How it works:

Inner query calculates average salary
Outer query fetches employees with salary greater than that average

Example Table: Employee
emp_id	name	salary
1	Tony	60000
2	Steve	50000
3	Bruce	40000
Average salary = 50,000

ğŸ‘‰ Output:

emp_id	name	salary
1	Tony	60000
Types of Subqueries (Interview Important)

1ï¸âƒ£ Single-row subquery
Returns one value

WHERE salary = (SELECT MAX(salary) FROM Employee)

2ï¸âƒ£ Multi-row subquery
Returns multiple values

WHERE dept_id IN (SELECT dept_id FROM Department)

17. Difference between correlated and non-correlated subquery

ğŸ”¹ Non-Correlated Subquery
A non-correlated subquery is a subquery that runs independently of the outer query.
Executes once
Result is passed to the outer query
Easier to understand and faster

Example

ğŸ‘‰ Employees earning more than average salary

SELECT *
FROM Employee
WHERE salary > (
    SELECT AVG(salary)
    FROM Employee
);

How it works:

Inner query calculates average salary
Outer query compares each employeeâ€™s salary to that value

ğŸ”¹ Correlated Subquery
A correlated subquery depends on the outer query.

Executes once for each row of the outer query
Uses values from the outer query
Slower but more powerful

Example

ğŸ‘‰ Employees earning more than the average salary of their department

SELECT *
FROM Employee e
WHERE salary > (
    SELECT AVG(salary)
    FROM Employee
    WHERE dept_id = e.dept_id
);

How it works:

For each employee, the subquery calculates department-wise average
Then compares employee salary with it

ğŸ§  Example Table
emp_id	name	dept	salary
1	Tony	IT	60000
2	Steve	IT	50000
3	Bruce	HR	40000
4	Natasha	HR	45000
Output of Correlated Query
name	dept	salary
Tony	IT	60000
Natasha	HR	45000

â­ Interview One-Liner
A non-correlated subquery runs independently, while a correlated subquery depends on the outer query and executes once per row.

18. Find 2nd / 3rd / 5th highest salary

3ï¸âƒ£ 3rd Highest Salary
SELECT salary
FROM (
    SELECT salary,
           DENSE_RANK() OVER (ORDER BY salary DESC) AS rnk
    FROM Employee
) t
WHERE rnk = 3;

ğŸ‘‰ It finds the 3rd highest DISTINCT salary from the Employee table.

Step-by-Step Explanation
ğŸ”¹ Step 1: Inner Query (Window Function)
SELECT salary,
       DENSE_RANK() OVER (ORDER BY salary DESC) AS rnk
FROM Employee;

What happens here?

ORDER BY salary DESC â†’ sorts salaries from highest to lowest

DENSE_RANK():

Assigns a rank to each distinct salary
Same salaries get the same rank
No gaps in ranking

ğŸ”¹ Example Data
emp_id	salary
1	100000
2	90000
3	90000
4	80000
5	70000
ğŸ”¹ Result of Inner Query
salary	rnk
100000	1
90000	2
90000	2
80000	3
70000	4
ğŸ”¹ Step 2: Outer Query (Filtering)
WHERE rnk = 3;

Filters rows where rank is 3
Returns the 3rd highest distinct salary

Final Output
80000

âœ… METHOD 2: Using LIMIT & OFFSET (MySQL / PostgreSQL)
SELECT DISTINCT salary
FROM Employee
ORDER BY salary DESC
LIMIT 1 OFFSET 1;   -- 2nd highest

LIMIT 1 OFFSET 2;   -- 3rd highest
LIMIT 1 OFFSET 4;   -- 5th highest

19. Find duplicate records in a table

Example Data
emp_id	name	email	salary
1	Tony	tony@gmail.com
	60000
2	Steve	steve@gmail.com
	55000
3	Tony	tony@gmail.com
	60000
4	Bruce	bruce@gmail.com
	40000
5	Tony	tony@gmail.com
	60000

Here, Tonyâ€™s record is duplicated.

âœ… Method 1: Using GROUP BY + HAVING (Most Common)
Find duplicate rows based on a column (e.g., email)
SELECT email, COUNT(*) AS cnt
FROM Employee
GROUP BY email
HAVING COUNT(*) > 1;

Output
email	cnt
tony@gmail.com
	3

ğŸ‘‰ Shows which values are duplicated

âœ… Method 2: Fetch the FULL duplicate records
SELECT *
FROM Employee
WHERE email IN (
    SELECT email
    FROM Employee
    GROUP BY email
    HAVING COUNT(*) > 1
);

Output

All rows where email = 'tony@gmail.com'

âœ… Method 3: Find duplicates using multiple columns
SELECT name, email, salary, COUNT(*)
FROM Employee
GROUP BY name, email, salary
HAVING COUNT(*) > 1;

ğŸ‘‰ Finds exact duplicate rows

ğŸ§  How to Explain in Interview (Simple)
We can find duplicate records using GROUP BY on the required column(s) and filter groups having COUNT(*) > 1 using HAVING.

20. Delete duplicate records (keep one)
The Query
DELETE FROM Employee
WHERE emp_id NOT IN (
    SELECT MIN(emp_id)
    FROM Employee
    GROUP BY email
);

What does this query do?

ğŸ‘‰ It deletes duplicate records from the Employee table
ğŸ‘‰ Keeps only one record per email
ğŸ‘‰ Specifically, it keeps the row with the smallest emp_id for each email

Example Table (Before)
emp_id	name	email
1	Tony	tony@gmail.com

2	Steve	steve@gmail.com

3	Tony	tony@gmail.com

4	Bruce	bruce@gmail.com

5	Tony	tony@gmail.com

Here:

tony@gmail.com appears 3 times

Step-by-Step Execution
ğŸ”¹ Step 1: Inner Query
SELECT MIN(emp_id)
FROM Employee
GROUP BY email;

Result of inner query:
email	MIN(emp_id)
tony@gmail.com
	1
steve@gmail.com
	2
bruce@gmail.com
	4

ğŸ‘‰ These are the records we want to KEEP

ğŸ”¹ Step 2: Outer DELETE
DELETE FROM Employee
WHERE emp_id NOT IN (1, 2, 4);

ğŸ‘‰ This deletes:

emp_id = 3
emp_id = 5

21. Find employees with salary greater than average salary

SELECT *
FROM Employee
WHERE salary > (
    SELECT AVG(salary)
    FROM Employee
);

ğŸ”µ Window Functions (Very High Chance)

What is a window function?

22. Difference between ROW_NUMBER(), RANK(), DENSE_RANK()

These are window (ranking) functions used to assign a rank to rows based on an order.

Example Table: Employee
emp_id	name	salary
1	Tony	100000
2	Steve	90000
3	Bruce	90000
4	Natasha	80000
5	Peter	70000
Query Used
SELECT name, salary,
       ROW_NUMBER() OVER (ORDER BY salary DESC) AS row_num,
       RANK() OVER (ORDER BY salary DESC) AS rnk,
       DENSE_RANK() OVER (ORDER BY salary DESC) AS dense_rnk
FROM Employee;

Output
name	salary	ROW_NUMBER	RANK	DENSE_RANK
Tony	100000	1	1	1
Steve	90000	2	2	2
Bruce	90000	3	2	2
Natasha	80000	4	4	3
Peter	70000	5	5	4
Key Differences Explained
ğŸ”¹ ROW_NUMBER()

Assigns unique number to each row
Does not care about duplicates
Always increments by 1
ğŸ‘‰ Use when you need unique row IDs

ğŸ”¹ RANK()

Same values get same rank
Skips ranks after duplicates
ğŸ‘‰ Use when ranking positions matter (like competition ranking)

ğŸ”¹ DENSE_RANK()

Same values get same rank
Does NOT skip ranks
ğŸ‘‰ Best for Nth highest salary

23. Use of PARTITION BY

24. SQL Order of Execution (Sequence of Operations)

SQL executes queries in a logical order starting from FROM â†’ WHERE â†’ GROUP BY â†’ HAVING â†’ SELECT â†’ ORDER BY â†’ LIMIT, not in the written order.

This is a very important interview question ğŸ‘

25. Find top 3 salaries in each department

Query
SELECT emp_id, name, department, salary
FROM (
    SELECT
        emp_id,
        name,
        department,
        salary,
        DENSE_RANK() OVER (
            PARTITION BY department
            ORDER BY salary DESC
        ) AS rnk
    FROM Employee
) t
WHERE rnk <= 3;

ğŸ”¹ Step-by-Step SQL Execution
1ï¸âƒ£ INNER QUERY â€“ FROM Employee
FROM Employee

SQL first reads all rows from the Employee table

No filtering yet

ğŸ“Œ At this point:

All employees are loaded

2ï¸âƒ£ WINDOW FUNCTION EXECUTION
DENSE_RANK() OVER (
    PARTITION BY department
    ORDER BY salary DESC
)

This happens after FROM and before WHERE of the outer query.

What SQL does internally:

Partitions data by department
Sorts each department by salary DESC
Assigns rank starting from 1 in each department
Same salary â†’ same rank
No gaps in ranking (because DENSE_RANK)

ğŸ“Œ Example (IT department):

Salary: 90000 â†’ rnk = 1
Salary: 85000 â†’ rnk = 2
Salary: 85000 â†’ rnk = 2
Salary: 70000 â†’ rnk = 3

3ï¸âƒ£ INNER SELECT List Execution
SELECT emp_id, name, department, salary, rnk

SQL now creates a temporary result set
This result includes the calculated rnk

Temporary Table (t)
emp_id	name	department	salary	rnk
1	A	IT	90000	1
2	B	IT	85000	2
3	C	IT	85000	2
4	D	IT	70000	3
5	E	HR	80000	1
6	F	HR	75000	2
7	G	HR	72000	3

ğŸ“Œ This result is aliased as t

4ï¸âƒ£ OUTER QUERY â€“ FROM t
FROM ( ... ) t

SQL treats the inner query as a derived table
Now all filtering happens on this result

5ï¸âƒ£ OUTER WHERE CLAUSE
WHERE rnk <= 3

SQL filters rows after ranking is completed
Keeps only top 3 salaries per department

ğŸ“Œ Important:

WHERE cannot directly filter window functions,
so we use a subquery.

6ï¸âƒ£ FINAL SELECT
SELECT emp_id, name, department, salary

Only required columns are returned

rnk is not shown

âœ… Final Output
emp_id	name	department	salary
1	A	IT	90000
2	B	IT	85000
3	C	IT	85000
4	D	IT	70000
5	E	HR	80000
6	F	HR	75000
7	G	HR	72000


ğŸ”¹ Why DENSE_RANK()?

Handles duplicate salaries
Ensures exactly top 3 salary levels